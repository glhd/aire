!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Aire={})}(this,function(e){"use strict";function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function p(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function m(e){var t=new FormData(e),r={},n=!0,a=!1,i=void 0;try{for(var o,l=t.entries()[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var s=y(o.value,2),c=s[0],u=s[1],f=c.replace(/\[]$/,""),d=f!==c;r[f]?(r[f]instanceof Array||(r[f]=[r[f]]),r[f].push(u)):r[f]=d?[u]:u}}catch(e){a=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}var h=!1,g={templates:{error:{prefix:"<li>",suffix:"</li>"}},classnames:{none:{},valid:{},invalid:{}},locale:"en",customAttributes:{}},b=function(e){e.form;var t=e.errors,r=e.data,n=e.rules,a=e.refs,i=e.touched,o=g.templates,v=g.classnames;Object.keys(n).forEach(function(e){if(e in a){var f=i.has(e)&&e in t,d=i.has(e)&&!f&&e in r;"errors"in a[e]&&(d?a[e].errors[0].innerHTML="":f&&(a[e].errors[0].innerHTML=t[e].map(function(e){return"".concat(o.error.prefix).concat(e).concat(o.error.suffix)}).join(""))),Object.entries(a[e]).forEach(function(e){var t=y(e,2),u=t[0];t[1].forEach(function(e){if(u in v.valid){var t,r=v.valid[u].split(" ");if(r.length)if(d)(t=e.classList).add.apply(t,p(r));else if(f){var n;(n=e.classList).remove.apply(n,p(r))}}if(u in v.invalid){var a,i=v.invalid[u].split(" ");if(i.length)if(f)(a=e.classList).add.apply(a,p(i));else if(d){var o;(o=e.classList).remove.apply(o,p(i))}}if(u in v.none){var l,s,c=v.none[u].split(" ");if(c.length)if(d||f)(l=e.classList).remove.apply(l,p(c));else(s=e.classList).add.apply(s,p(c))}})})}})},A="undefined"!=typeof FormData&&"getAll"in FormData.prototype;e.configure=function(e){"en"!==(g=e).locale&&Validator.setMessages(g.locale,require("./lang/".concat(g.locale))),Validator.useLang(g.locale)},e.connect=function(e,t,r){var a=1<arguments.length&&void 0!==t?t:{},i=2<arguments.length&&void 0!==r?r:{};if(!A)return null;h||Validator.registerMissedRuleValidator(function(){return!0},""),h=!0;function n(e,t,r){c[e]=c[e]||{},c[e][t]=c[e][t]||[],c[e][t].push(r)}var o,l,s="string"==typeof(o=e)?document.querySelector(o):o,c={};s.querySelectorAll("[data-aire-component]").forEach(function(e){if("aireFor"in e.dataset){var t=e.dataset.aireFor,r=e.dataset.aireComponent;n(t,r,e),"aireValidationKey"in e.dataset&&r!==e.dataset.aireValidationKey&&n(t,e.dataset.aireValidationKey,e)}});function u(e){var t=e.target.getAttribute("name");t&&p.add(t.replace(/\[]$/,""))}function f(e){void 0!==e&&"target"in e&&u(e);var n=0;clearTimeout(d),d=setTimeout(function(){var e=m(s);(l=new Validator(e,a,i)).setAttributeNames(g.customAttributes);var t=++n;1==t&&Object.entries(e).forEach(function(e){var t=y(e,2),r=t[0],n=t[1];null!=n&&""!==n&&(Array.isArray(n)&&0===n.length||r in c&&"errors"in c[r]&&0<c[r].errors[0].childElementCount||p.add(r))});function r(){v&&t===n&&b({form:s,rules:a,touched:p,refs:c,data:e,errors:l.errors.all()})}l.checkAsync(r,r)},250)}var d,v=!0,p=new Set;s.addEventListener("change",f,!0),s.addEventListener("keyup",f,!0),s.addEventListener("focus",u,!0),f();return{get valid(){return void 0!==l&&0===Object.keys(l.errors.all()).length},get data(){return void 0===l?m(s):l.input},get validator(){return l},run:f,disconnect:function(){v=!1,clearTimeout(d),s.removeEventListener("change",f),s.removeEventListener("keyup",f),s.removeEventListener("focus",u)}}},e.setRenderer=function(e){b=e},e.supported=A,Object.defineProperty(e,"__esModule",{value:!0})});
